% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_nar.R
\name{compute_nar}
\alias{compute_nar}
\title{Compute Nutrient Adequacy Ratio (NAR) and Mean Adequacy Ratio (MAR)}
\usage{
compute_nar(
  data,
  age_col,
  life_group,
  nutrients,
  bioavailability = "moderate",
  include_rni_values = TRUE
)
}
\arguments{
\item{data}{A data frame or tibble containing dietary intake and age data.}

\item{age_col}{Character scalar. Name of the column representing the individual's age
(in years for adults and months for children).}

\item{life_group}{Character scalar specifying the life-stage group.
Must be one of \code{"Female"}, \code{"Male"}, \code{"Child"}, \code{"Pregnant"}, or \code{"Lactating"}.}

\item{nutrients}{A named character vector mapping nutrient names to their
corresponding column names in the dataset.
Example: \code{c("Protein" = "Protein_g", "Iron" = "Iron_mg")}}

\item{bioavailability}{Character scalar specifying the assumed dietary
bioavailability for iron and zinc. Must be one of \code{"low"}, \code{"moderate"}, or \code{"high"}.
Defaults to \code{"moderate"}.}

\item{include_rni_values}{Logical. If \code{TRUE}, the RNI columns are included in the
output dataset. Defaults to \code{TRUE}.}
}
\value{
A tibble containing:
\itemize{
\item The original dataset columns.
\item Computed NAR columns for each nutrient (e.g., \code{Female_Protein_g_adequacy_ratio}).
\item Optional RNI columns for each nutrient (if \code{include_rni_values = TRUE}).
\item A summary column representing the life group–specific MAR
(e.g., \code{Female_mean_adequacy_ratio}).
}
}
\description{
The Nutrient Adequacy Ratio (NAR) represents the adequacy of an individual's
usual intake relative to the Recommended Nutrient Intake (RNI):

\deqn{NAR = min(Usual Intake / RNI, 1)}

The Mean Adequacy Ratio (MAR) is the average of NARs across multiple nutrients:

\deqn{MAR = (Σ NAR_i) / n}

This approach is widely used to assess the overall diet quality of individuals
or population subgroups. Values are capped at 1 to prevent high intakes of one
nutrient from compensating for inadequacies in others.
}
\details{
This function calculates nutrient adequacy ratios (NARs) for individual nutrients
and the mean adequacy ratio (MAR) across multiple nutrients using the
Recommended Nutrient Intake (RNI) as reference values. It accommodates
bioavailability adjustments for zinc and iron and automatically matches
RNI values based on age and life-stage group.

\strong{How RNIs Are Determined:}
\itemize{
\item For general nutrients (e.g., Vitamin A, vitamin C, folate etc), RNIs are retrieved
from the internal \code{.rni_reference()} table based on \code{life_group} and \code{age}.
\item The function currently supports these nutrients: Vitamin A, Vitamin C, Vitamin D, Vitamin E,
Thiamin, Riboflavin, Niacin, Vitamin B6, Folate, Vitamin B12, Calcium, Selenium, Iodine, Copper,
Magnesium, Molybdenum, Phosphorus, Sodium, Potassium, Iron (bioavailability must be selected), Zinc (bioavailability must be selected).
\item For \strong{zinc} and \strong{iron}, bioavailability-adjusted RNIs are obtained using
\code{.get_zinc_rni()} and \code{.get_iron_rni()}, respectively.
}

\strong{Units:}
Ensure that the intake units in your dataset correspond to those used in the RNI
reference values (e.g., mg/day, µg/day, g/day).

\strong{Mean Adequacy Ratio (MAR):}
\itemize{
\item Computed as the mean of all nutrient adequacy ratios per individual.
\item The column name includes the life group prefix
(e.g., \code{"Female_mean_adequacy_ratio"}).
}
}
\examples{
df <- tibble::tibble(
  age = c(10, 25, 35),
  Calcium_g = c(1000, 500, 800),
  Iron_mg = c(7, 12, 9)
)

nutrients <- c("Calcium" = "Calcium_g", "Iron" = "Iron_mg")

compute_nar(
  data = df,
  age_col = "age",
  life_group = "Female",
  nutrients = nutrients,
  bioavailability = "moderate",
  include_rni_values = TRUE
)

}
\references{
FAO/WHO (2002). \emph{Human Vitamin and Mineral Requirements}.
Allen, L. et al. (2006). \emph{An Interactive 24-Hour Recall for Assessing the Adequacy of Iron and Zinc Intakes in Developing Countries}. HarvestPlus Technical Monograph 8.
Institute of Medicine (2006). \emph{Dietary Reference Intakes: The Essential Guide to Nutrient Requirements}.
}

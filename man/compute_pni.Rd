% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_pni.R
\name{compute_pni}
\alias{compute_pni}
\title{Compute Probability of Nutrient Inadequacy (PNI)}
\usage{
compute_pni(
  data,
  age_col,
  life_group,
  nutrients,
  bioavailability = "moderate",
  cv = 0.1,
  include_ear_values = TRUE
)
}
\arguments{
\item{data}{A data frame or tibble containing age and nutrient intake data.}

\item{age_col}{Character string. Column name for age (years for adults, months for children).}

\item{life_group}{Character string specifying the life-stage group.
Must be one of \code{"Female"}, \code{"Male"}, \code{"Child"}, \code{"Pregnant"}, or \code{"Lactating"}.}

\item{nutrients}{A named character vector, where names are nutrient names
(e.g. \code{"Protein"}) and values are corresponding column names in the dataset.}

\item{bioavailability}{Character string specifying dietary bioavailability
for zinc and iron: one of \code{"low"}, \code{"moderate"}, or \code{"high"}. Defaults to \code{"moderate"}.}

\item{cv}{Numeric. Coefficient of variation (CV) used to approximate the
standard deviation of the requirement distribution as a proportion of the
EAR (i.e., SD = cv × EAR). Defaults to 0.1, following the convention
applied by Allen et al. (2006) and IOM probability method assumptions.
A smaller CV assumes less variability in nutrient requirements, while a
larger CV increases the spread and thus changes the computed inadequacy
probabilities.}

\item{include_ear_values}{Logical. If \code{TRUE}, includes nutrient EAR columns in the output.}
}
\value{
A tibble containing the original data plus the computed PNI and optionally
the EAR values for each nutrient.
}
\description{
This function estimates the probability of nutrient inadequacy (PNI) for each
individual using the probability approach, following Institute of Medicine (IOM)
and Allen et al. (2006) guidelines. It combines EAR-based probability estimates
for general nutrients with bioavailability-adjusted reference values for zinc and
lookup-based probabilities for iron. Pregnant and lactating groups are not covered in Allen et al. (2006)
because their requirement distributions are not represented by the same model.
}
\details{
For each nutrient:
\itemize{
\item \strong{General nutrients} use the normal probability approach:
\deqn{PNI = 1 - Φ((intake - EAR) / (0.1 × EAR))}
- \strong{Zinc} uses EAR values adjusted for bioavailability (FAO/WHO 2002).
\item \strong{Iron} uses skewed, lookup-based probability tables from Allen et al. (2006).
}

Each nutrient produces two columns: one for EAR values and one for PNI,
each prefixed with the life group (e.g., \code{Female_Protein_g_ear}, \code{Female_Protein_g_pni}).
}
\examples{
df <- tibble::tibble(age = c(25, 10, 30), Protein_g = c(0.7, 0.6, 0.8))
nutrients <- c("Protein" = "Protein_g")
compute_pni(df, "age", "Female", nutrients)

}
\references{
Institute of Medicine (US). Dietary Reference Intakes Tables. 2006.
Allen, L. et al. (2006). An interactive 24-hour recall for assessing the adequacy
of iron and zinc intakes in developing countries. HarvestPlus Technical Monograph 8.
}

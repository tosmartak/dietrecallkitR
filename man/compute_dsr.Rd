% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_dsr.R
\name{compute_dsr}
\alias{compute_dsr}
\title{Compute Dietary Species Richness (DSR)}
\usage{
compute_dsr(
  recall_data,
  id_col,
  food_item_col,
  use_fct_db = FALSE,
  dsr_map_data = NULL,
  dsr_map_food = NULL,
  dsr_map_col = NULL,
  add_prefix = NULL
)
}
\arguments{
\item{recall_data}{A data frame containing at least the ID column and the food item column.}

\item{id_col}{Character. Name of the identifier column in \code{recall_data}
(e.g., \code{"survey_id"}).}

\item{food_item_col}{Character. Column in \code{recall_data} containing food item names.}

\item{use_fct_db}{Logical, default = FALSE. If TRUE, uses the package's
online FCT database (\code{species} column).}

\item{dsr_map_data}{Optional. A user-provided mapping data frame with
food items and species names. Required if \code{use_fct_db = FALSE}.}

\item{dsr_map_food}{Character. Column name in \code{dsr_map_data} that matches food items.}

\item{dsr_map_col}{Character. Column name in \code{dsr_map_data} containing species names.}

\item{add_prefix}{Optional character. Prefix to add to the output column name (e.g., \code{"child"} will produce \code{child_dsr}).}
}
\value{
A tibble with:
\itemize{
\item The ID column (as provided in \code{id_col})
\item One column for the computed dietary species richness (\code{dsr} or prefixed name)
}
}
\description{
Computes the Dietary Species Richness (DSR) score from cleaned dietary recall data.
The function counts the number of distinct species consumed per respondent or recall ID.
Users can either use the package FCT database (online CSV) or supply their own mapping file.
}
\details{
\itemize{
\item If \code{use_fct_db = TRUE}, the function pulls from the online FCT database used in \code{dietrecallkitR}.
\item Foods with \code{"No Species Assignment"} or \code{NA} species are excluded from the count.
\item Duplicate species per ID are counted once.
\item Returns warnings for unmapped items.
}
}
\examples{
# Using online FCT DB
recall_sample <- data.frame(
  survey_id = c(1, 1, 2, 2, 3),
  desc_of_food = c(
    "Rabbit meat, raw",
    "Ghee (cow milk)",
    "Cheese, cheddar, regular fat",
    "Tuna, grilled",
    "Rabbit meat, raw"
  )
)

result <- compute_dsr(
  recall_data   = recall_sample,
  id_col        = "survey_id",
  food_item_col = "desc_of_food",
  use_fct_db    = TRUE
)
print(result)

# Using custom mapping
species_map <- data.frame(
  item = c("Rabbit meat, raw", "Tuna, grilled", "Cheese, cheddar, regular fat", "Ghee (cow milk)"),
  species = c("Rabbit", "Tuna", "Cow", "Cow")
)

result <- compute_dsr(
  recall_data   = recall_sample,
  id_col        = "survey_id",
  food_item_col = "desc_of_food",
  use_fct_db    = FALSE,
  dsr_map_data  = species_map,
  dsr_map_food  = "item",
  dsr_map_col   = "species",
  add_prefix    = "child"
)
print(result)

}

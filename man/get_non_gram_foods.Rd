% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_non_gram_foods.R
\name{get_non_gram_foods}
\alias{get_non_gram_foods}
\title{Get Non-Gram Foods}
\usage{
get_non_gram_foods(
  filepath,
  subcounty_col = "subcounty",
  maintable_sheet = "maintable",
  food_details_sheet = "food_details",
  food_ingredients_sheet = "food_ingredients_group",
  export_path = NULL
)
}
\arguments{
\item{filepath}{Path to the Excel file containing the dietary recall sheets.}

\item{subcounty_col}{Name of the subcounty column in the maintable.
Defaults to \code{"subcounty"}.}

\item{maintable_sheet}{Name of the sheet containing the maintable.
Defaults to \code{"maintable"}.}

\item{food_details_sheet}{Name of the sheet containing the food details.
Defaults to \code{"food_details"}.}

\item{food_ingredients_sheet}{Name of the sheet containing food ingredients.
Defaults to \code{"food_ingredients_group"}.}

\item{export_path}{Optional. File path to export results as an Excel file.
If supplied, the Excel file will be created with all required columns and
empty \code{amount} and \code{gram} fields for later user input.}
}
\value{
A tibble with columns:
\describe{
\item{subcounty}{Subcounty identifier}
\item{food_item}{Food item consumed or ingredient used}
\item{unit}{Original unit recorded (not grams)}
\item{amount}{Empty column for later input}
\item{gram}{Empty column for later input}
}
}
\description{
Extracts unique food items from a dietary recall Excel file where units are
not measured in grams (scale or photobook). Combines results from the
\code{food_details} and \code{food_ingredients_group} sheets and links them
with household subcounty information from the \code{maintable}.
}
\details{
Optionally, the results can be exported to Excel. The exported file contains
all relevant columns, with two extra empty columns (\code{amount}, \code{gram})
for user input. Users are expected to fill in only these two columns and
should avoid modifying \code{subcounty}, \code{food_item}, or \code{unit}.

If all food items in the dataset are recorded in grams
("g from scale" or "g from photobook"), the function will return
an empty tibble with the correct columns, print a message to the user,
and skip Excel export (even if \code{export_path} is provided).
}
\examples{
\dontrun{
# Return tibble only
get_non_gram_foods("dietary_recall_full.xlsx")

# Return tibble and export to Excel
get_non_gram_foods("dietary_recall_full.xlsx", export_path = "non_gram_foods.xlsx")
}

}

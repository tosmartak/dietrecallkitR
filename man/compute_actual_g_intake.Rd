% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_actual_g_intake.R
\name{compute_actual_g_intake}
\alias{compute_actual_g_intake}
\title{Compute Actual Gram Intake}
\usage{
compute_actual_g_intake(
  filepath,
  non_gram_file = NULL,
  maintable_sheet = "maintable",
  food_details_sheet = "food_details",
  food_ingredients_sheet = "food_ingredients_group",
  location_col = "subcounty"
)
}
\arguments{
\item{filepath}{Path to the Excel file containing dietary recall data.}

\item{non_gram_file}{Optional. Path to a completed non-gram conversion Excel file.
If NULL, the function will check for non-gram units and stop if found.}

\item{maintable_sheet}{Name of the maintable sheet (default = \code{"maintable"}).}

\item{food_details_sheet}{Name of the food details sheet (default = \code{"food_details"}).}

\item{food_ingredients_sheet}{Name of the food ingredients sheet
(default = \code{"food_ingredients_group"}).}

\item{location_col}{Name of the location column in the maintable
(e.g., subcounty, district). Defaults to \code{"subcounty"}.}
}
\value{
A tibble with columns:
\describe{
\item{survey_id}{Survey identifier}
\item{food_item}{Name of food or ingredient}
\item{amt_consumed}{Amount reported}
\item{unit}{Unit of measurement}
\item{prop_consumed}{Proportion consumed (default = 1 if missing)}
\item{gram_per_unit}{Conversion factor (grams per unit, from non-gram foods)}
\item{actual_gram_intake}{Final computed intake in grams}
}
}
\description{
Computes the actual gram intake for foods and ingredients from dietary recall
data. Handles both gram-based and non-gram units, with support for user-
provided non-gram conversion data (from \code{get_non_gram_foods()}).
}
\details{
\itemize{
\item If \code{non_gram_file} is NULL and non-gram units are found, the function
will stop and request a conversion sheet.
\item If provided, the non-gram conversion file must include the same location column
(specified in \code{location_col}), along with columns
\code{food_item}, \code{unit}, \code{amount}, and \code{gram}.
\item The function warns the user if any non-gram foods lack a valid
\code{gram_per_unit}.
}
}
\examples{
\dontrun{
compute_actual_g_intake("dietary_recall_full.xlsx",
  non_gram_file = "non_gram_foods_conversion_data.xlsx"
)
}

}
